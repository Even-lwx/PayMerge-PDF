# 该脚本原创作者为ZhangStudyLife，我仅在其基础上做了优化

# 发票合并脚本

本工具在当前目录下生成 `已合并` 文件夹，并把成套的发票与记录合并为 单页 PDF：

- 单页布局（A4 纵向、白底、四边 15mm 小边距）：
  - 上半页：源发票 PDF 的第一页，等比缩放居中显示（占上半区域）。
  - 下半页：购买记录 和 支付记录 两张图片，左右并排，各占四分之一页面面积（即各占下半区域的一半），等比缩放居中显示。

命名匹配：

- 源文件：`[编号+名称+价格].pdf`（示例：`1吸尘器风扇15.4.pdf`）
- 购买记录：`[相同前缀]购买记录.(jpg|jpeg|png)`
- 支付记录：`[相同前缀]支付记录.(jpg|jpeg|png)`
- 输出：`已合并/[相同前缀]已合并.pdf`

若三者不齐全，则跳过。若输出已存在，也跳过（不会覆盖）。不会修改任何源文件。

## 环境准备（Windows PowerShell）

建议使用 Python 3.9+。

```powershell
# 进入此目录后安装依赖
pip install -r requirements.txt

# 运行脚本（会在本目录创建“已合并”文件夹）
python .\merge_invoices.py
```

## 常见问题

- 输出 PDF 为一页：脚本取源 PDF 的第一页并与两张记录图排在一页内。
- 图片方向/大小：会等比缩放放入各自半页区域，不会拉伸变形。
- 编码问题：文件名为中文时，一般无需特别设置；若报错，确保系统编码与 Python 环境支持 UTF-8。
